# Spark-Dataframe-ipynb
Practice spark dataframe
Что нужно сделать

В работе нужно реализовать код и все необходимые операции, сделать выводы и дать комментарии по решению. Работать будем с такими данными:

    Загрузка и анализ данных из CSV-файла
        Разархивируйте sales_data.zip, в нем данные по продажам за 12 месяцев 2019 г. Считайте  в Spark DataFrame каждый из них и объедините в один большой датафрейм методом union, добавьте колонку month для обозначения месяца.
        Выведите схему (schema) DataFrame и общую статистику по данным.
        Выясните, какие товары пользуются наибольшим спросом (больше всего продаж), выведите Топ-10 товаров и кол-во их покупок.
    Партиционирование данных и оптимизация производительности
        Добавьте партиционирование в датафрейм, используя выбранный столбец как ключ партиционирования, и объясните свой выбор.
        Выполните операцию агрегации данных (например, суммирование кол-во проданных штук) по партициям.
        Оцените производительность и сравните её с непартиционированной таблицей, например замерив все выполнения кода в ячейках Jupyter notebook с помощью %timeit. 
        Измените количество партиций на одну и запишите файл обратно на диск.
    Работа с различными форматами данных
        Сохраните датафрейм с данными, изначально хранящиеся в формате CSV, в других доступных форматах. Например, JSON, Parquet, Avro, ORC.
        Проанализируйте различия в производительности (как быстро запись происходит) и объёме хранения для каждого формата на диске компьютера.
        Сделайте выводы, оцените плюсы и минусы разных форматов.
    Работа с UDF и кешированием
        Создайте UDF на Python, которая парсит адрес покупателя и разбивает колонку Purchase Address на Street address, City, State, Postal Code. 
        Примените UDF к Spark DataFrame и убедитесь, что форматирование прошло успешно и добавились 4 новые колонки.
        Сделайте ещё одно преобразование датафрейма - перемножьте проданные штуки на цену единицы товара, получите Total price, предварительно закешировав (cache) результат применения UDF.
        Оцените скорость выполнения всей цепочки преобразований датафрейма (UDF и добавление Total price) без кеширования и с его наличием.
        Придумайте и опишите пример из жизни, когда кеширование важно применять и почему это может быть полезно.
